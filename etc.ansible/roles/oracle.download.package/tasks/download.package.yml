- name: "ORACLE_HOME gi/db"
  file:
    path: "{{ oracle_home }}"
    state: directory
    owner: oracle
    group: oinstall
    recurse: yes
    mode: '0775'

- name: "TMP_DIR /oracle/u01/tmp"
  file:
    path: /oracle/u01/tmp
    state: directory
    owner: oracle
    group: oinstall
    recurse: yes
    mode: '1777'

- block:
    - debug:
        msg: "Unpack into {{ oracle_home }}"
    - name: Download install package {{ oracle_install_package_name }}
      get_url:
        url: http://192.168.8.200/oracle/{{ oracle_major_version }}/{{ oracle_install_package_name }}
        dest: /oracle/u01/tmp/
        mode: '0640'

    - name: unzip install package {{ oracle_install_package_name }}
      unarchive:
        src: /oracle/u01/tmp/{{ oracle_install_package_name }}
        dest: "{{ oracle_home }}"
        remote_src: yes

    - name: delete install .zip package {{ oracle_install_package_name }}
      file:
        path: /oracle/u01/{{ oracle_install_package_name }}
        state: absent

  become: yes
  become_user: oracle

- name: "TMP_DIR /oracle/u01/tmp"
  file:
    path: /oracle/u01/tmp/
    state: absent


